<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>心遇 XinYou - Public Profile MVP</title>
  <link rel="stylesheet" href="./style.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script defer src="./app.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">心遇 XinYou</div>
    <nav class="tabs" id="tabs">
      <button class="tab active" data-tab="encounter">巧遇</button>
      <button class="tab" data-tab="me">我的資料</button>
      <button class="tab" data-tab="diary">日記</button>
      <button class="tab" data-tab="friends">好友</button>
      <button class="tab" data-tab="panel">Supabase Test Panel</button>
    </nav>
  </header>

  <main class="container">
    <section class="card" id="statusCard">
      <div class="row">
        <div>
          <div class="h1">狀態</div>
          <div class="muted" id="statusText">尚未初始化 Supabase。</div>
        </div>
        <div class="right">
          <button class="btn ghost" id="refreshBtn">重新整理</button>
        </div>
      </div>
      <div class="small muted" id="userHint">請先到「Supabase Test Panel」初始化，再登入。</div>
    </section>

    <!-- Encounter -->
    <section class="card" data-view="encounter">
      <div class="row">
        <div class="h1">巧遇</div>
        <div class="right">
          <input class="input" id="searchUsers" placeholder="搜尋暱稱（可空）" />
        </div>
      </div>
      <div class="split">
        <div class="pane">
          <div class="h2">使用者列表</div>
          <div class="list" id="userList"></div>
        </div>
        <div class="pane">
          <div class="h2">公開檔案</div>
          <div id="publicProfile"></div>
        </div>
      </div>
    </section>

    <!-- Me -->
    <section class="card hidden" data-view="me">
      <div class="h1">我的資料</div>

      <div class="grid2">
        <div>
          <label class="label">暱稱</label>
          <input class="input" id="meDisplayName" placeholder="例如：小狼" />
        </div>

        <div>
          <label class="label">性別</label>
          <select class="input" id="meGender">
            <option value="">未選</option>
            <option value="male">男</option>
            <option value="female">女</option>
          </select>
        </div>

        <div>
          <label class="label">年齡層</label>
          <select class="input" id="meAgeRange">
            <option value="">未選</option>
            <option value="18-20">18–20</option>
            <option value="20-25">20–25</option>
            <option value="25-30">25–30</option>
            <option value="30-35">30–35</option>
            <option value="35-40">35–40</option>
            <option value="40-45">40–45</option>
            <option value="45+">45+</option>
          </select>
        </div>

        <div>
          <label class="label">一句話自介（可選）</label>
          <input class="input" id="meBio" placeholder="例如：喜歡露營、慢旅行。" />
        </div>
      </div>

      <div class="row mt">
        <button class="btn" id="saveProfileBtn">儲存資料</button>
        <div class="muted small" id="saveProfileHint"></div>
      </div>

      <hr class="sep" />

      <div class="h2">大頭貼 / 相簿</div>
      <div class="row">
        <input type="file" id="photoInput" accept="image/*" multiple />
        <button class="btn" id="uploadPhotosBtn">上傳到相簿</button>
        <button class="btn ghost" id="reloadPhotosBtn">重新讀取</button>
      </div>

      <div class="grid3 mt" id="mePhotos"></div>

      <hr class="sep" />

      <div class="h2">登入 / 登出（放在填寫資料最底部）</div>

      <div class="grid2">
        <div>
          <label class="label">Email</label>
          <input class="input" id="authEmail" placeholder="example@gmail.com" />
        </div>
        <div>
          <label class="label">Password</label>
          <input class="input" id="authPassword" type="password" placeholder="至少 6 碼" />
        </div>
      </div>

      <div class="row mt">
        <button class="btn" id="signUpBtn">註冊</button>
        <button class="btn" id="signInBtn">登入</button>
        <button class="btn danger" id="signOutBtn">登出 Email（切換帳號）</button>
        <div class="muted small" id="authHint"></div>
      </div>
    </section>

    <!-- Diary -->
    <section class="card hidden" data-view="diary">
      <div class="row">
        <div class="h1">日記</div>
        <div class="right">
          <button class="btn ghost" id="reloadDiariesBtn">重新讀取</button>
        </div>
      </div>

      <div class="h2">新增日記</div>
      <div class="grid2">
        <div>
          <label class="label">標題</label>
          <input class="input" id="diaryTitle" placeholder="例如：今天的心情" />
        </div>
        <div class="row vcenter">
          <label class="label">公開</label>
          <label class="toggle">
            <input type="checkbox" id="diaryPublic" />
            <span>is_public=true</span>
          </label>
        </div>
      </div>
      <label class="label">內容</label>
      <textarea class="textarea" id="diaryContent" placeholder="寫點什麼…"></textarea>
      <div class="row mt">
        <button class="btn" id="addDiaryBtn">新增</button>
        <div class="muted small" id="diaryHint"></div>
      </div>

      <hr class="sep" />

      <div class="h2">我的日記</div>
      <div class="list" id="myDiaries"></div>
    </section>

    <!-- Friends -->
    <section class="card hidden" data-view="friends">
      <div class="row">
        <div class="h1">好友</div>
        <div class="right">
          <button class="btn ghost" id="reloadFriendsBtn">重新讀取</button>
        </div>
      </div>

      <div class="split">
        <div class="pane">
          <div class="h2">好友名單</div>
          <div class="list" id="friendsList"></div>
        </div>
        <div class="pane">
          <div class="h2">好友邀請</div>
          <div class="h3">收到的邀請</div>
          <div class="list" id="incomingRequests"></div>
          <div class="h3 mt">我送出的邀請</div>
          <div class="list" id="outgoingRequests"></div>
        </div>
      </div>
    </section>

    <!-- Panel -->
    <section class="card hidden" data-view="panel">
      <div class="h1">Supabase Test Panel</div>
      <div class="grid2">
        <div>
          <label class="label">SUPABASE_URL</label>
          <input class="input" id="sbUrl" placeholder="https://xxxx.supabase.co" />
        </div>
        <div>
          <label class="label">ANON_KEY</label>
          <input class="input" id="sbAnon" placeholder="eyJhbGciOi..." />
        </div>
      </div>
      <div class="row mt">
        <button class="btn" id="initBtn">Initialize</button>
        <button class="btn ghost" id="clearBtn">清除設定</button>
        <div class="muted small" id="panelHint"></div>
      </div>

      <hr class="sep" />

      <div class="h2">快速檢查</div>
      <div class="list" id="debugBox"></div>
    </section>
  </main>

  <footer class="footer muted small">
    Public Profile MVP / Supabase JS v2
  </footer>
</body>
</html>
